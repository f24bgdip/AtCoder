AAABCABCABCAABCABCBBBAABCBCCCAAABCBCBCC
AAABCABCAABCABCBBBAABCBCCCAAABCBCBCC
AAABCAABCABCBBBAABCBCCCAAABCBCBCC
AAAABCABCBBBAABCBCCCAAABCBCBCC
AAAABCBBBAABCBCCCAAABCBCBCC
AAABBBAABCBCCCAAABCBCBCC
AAABBBABCCCAAABCBCBCC
AAABBBCCAAABCBCBCC
AAABBBCCAABCBCC
AAABBBCCABCC
AAABBBCCC


E-問題文
頂点に 1 から N の番号が、辺に 1 から M の番号がついた N 頂点 M 辺の重み付き単純連結無向グラフと正整数 K が与えられます。辺 i (1≤i≤M) は頂点 u(i)と頂点 v(i)を結んでおり、重みは w(i)です。

このグラフの全域木 T に対して、T のコストを T に含まれる辺の重みの総和を K で割ったあまりで定めます。 このグラフの全域木のコストの最小値を求めてください。

制約
2≤N≤8
N−1≤M≤ N(N−1)/2
​1≤K≤10^15
1≤u(i)<v(i)≤N(1≤i≤M)
0≤w(i)<K(1≤i≤M)
与えられるグラフは単純かつ連結
入力はすべて整数

parent[0] = 0
parent[1] = 1
parent[2] = 2
parent[3] = 3
parent[4] = 4
parent[5] = 5
parent[6] = 6
parent[7] = 7
parent[8] = 0

7 8 11298381761479
3 7 12070267388230
3 5 44548707643622
2 7 307226438833222
3 6 307262781240755
1 5 383643612490312
2 8 447399029952998
6 8 449873635430228
1 2 473294720906780
4 8 549007536393172
1 6 557102781022861

4 5 560567890325333
2 5 581822471860662
4 7 588263818615687
1 7 623179288538138
3 4 636318083622768

3 8 700247263184082
4 6 704726113717147
1 4 709363019414774
5 8 713928998174272
1 8 739618599410809

2 6 740549363586558
1 3 743030800139244
6 7 751331074538826
5 6 779230871080408
5 7 825982583786498

2 3 857687812294404
2 4 893923168139714

11298381761479
12070267388230
44548707643622
307226438833222
307262781240755
383643612490312 
549007536393172

F-Good Set Query
問題文
Q 個の整数の3つ組 (a1 ,b1​ ,d1 ),(a2​ ,b2​ ,d2),…,(aQ ,bQ ,dQ) が与えられます。

集合{1,2,…,Q} の部分集合 S が良い集合であることを、 下記の条件を満たす長さ N の整数列 (X1 ,X2 ,…,XN ) が存在することと定めます。

すべてのi∈S について、Xai −Xbi =diが成り立つ。

S が空集合である状態から始め、i=1,2,…,Q の順に下記の操作を行います。

もし S∪{i} が良い集合なら、S をS∪{i} で置き換える。

最終的な S のすべての要素を昇順に出力してください。

制約
入力される値はすべて整数
1≤ N,Q ≤ 2×10^5
1 ≤a(i) ,bi≤ N
−10^9 ≤ d(i) ≤ 10^9

入力
入力は以下の形式で標準入力から与えられる。

N Q
a1 b1 d1
​a2 b2 d2
⋮
aQ bQ dQ
​ 
出力
最終的なSのすべての要素を昇順に並べた列 (s1 ,s2 ,…,sk) を、下記の形式で空白区切りで出力せよ。

s1 s2 … sk

入力例 1
3 5
1 2 2
3 2 -3
2 1 -1
3 3 0
1 3 5

出力例 1
1 2 4 5

S が空集合である状態から始め、i=1,2,3,4,5 の順に問題文中の操作を下記の通り行います。
i=1 について、集合 S∪{i}={1} は良い集合です。なぜなら、例えば (X1 ,X2 ,X3)=(3,1,4) が問題文中の条件を満たすからです。よって、S を {1} で置き換えます。
i=2 について、集合 S∪{i}={1,2} は良い集合です。なぜなら、例えば (X1 ,X2 ,X3)=(3,1,−2) が問題文中の条件を満たすからです。よって、S を {1,2} で置き換えます。
i=3 について、集合 S∪{i}={1,2,3} は良い集合ではありません。
i=4 について、集合 S∪{i}={1,2,4} は良い集合です。なぜなら、例えば (X1 ,X2 ,X3)=(3,1,−2) が問題文中の条件を満たすからです。よって、S を 
{1,2,4} で置き換えます。
i=5 について、集合 S∪{i}={1,2,4,5} は良い集合です。なぜなら、例えば (X1 ,X2 ,X3)=(3,1,−2) が問題文中の条件を満たすからです。よって、S を {1,2,4,5} で置き換えます。
よって、最終的な S は {1,2,4,5} です。
