AtCoder AHC023 の学習を行います。

A - Crops on Grid/ 
実行時間制限: 2 sec / メモリ制限: 1024 MB

問題文
サイズが H×W の長方形の土地があります。この土地はサイズ 1×1 の正方形の区画に分割されており、区画と区画の境界は一部が水路となっています。また、土地の外周は柵で囲まれており、外周に一箇所だけ設置されている出入口からのみ出入りできます。出入口はいずれか一つの区画の一辺に含まれており、複数の区画にまたがることはありません。
あなたはこの土地を使って作物を育てたいと考えました。ある区画で作物を植えたり収穫したりするときは農機を使うので、出入口からその区画まで農機を移動させる必要があります。ただし、農機が通るための通路は設置されていません。
これから通路を整備するのは大変なため、あなたは作物を栽培中ではない区画だけを通って農機を移動させることにしました。すなわち、ある区画に作物を植えるときやある区画から作物を収穫するときは、出入口から目的の区画まで以下の条件のもとで到達できなければなりません。
・各区画からは隣接する4区画にのみ移動できる（斜めには移動できない）
・ただし、境界が水路であるような二つの区画の間は直接移動できない
・栽培中の区画を通ってはならない
これから T ヶ月の間に栽培する作物の候補が K 種類あり、1,2,…,K と番号が付けられています。作物 k を栽培するには、S(k)​ヶ月目までに植える必要があります。また、作物 k は D(k)​ヶ月目に収穫する必要があります。作物 k を S(k)​ヶ月目より早く植えることは可能ですが、その場合でも D(k)​ヶ月目より早く収穫することはできません。
どの作物をどの区画で栽培してもかまいませんが、一つの作物を複数の区画で栽培したり、複数の作物を一つの区画で同時に栽培したりすることはできません。
なるべく多くの区画を有効に利用できるような計画を立ててください。

土地情報の詳細
土地は北西の角の座標が (0,0)、南西の角の座標が (H,0)、北東の角の座標が (0,W)、南東の角の座標が (H,W) です。北から i+1 番目、西から j+1 番目の区画は点 (i,j) と点 (i+1,j+1) を対角線とする正方形であり、これを区画 (i,j) と呼ぶことにします(0≤i≤H−1, 0≤j≤W−1)。
出入口は区画 (i(0)​ ,0) の西側の境界部分（言い換えると、点 (i(0)​ ,0) と点 (i(0)​ +1,0) を結ぶ線分上）にあります。辺を共有する2区画の境界のそれぞれについて、その部分に水路があるかどうかが指定されます。水路の情報のフォーマットは「入力」のセクションを参照してください。
計画の詳細
計画は、どの作物をどの区画で作り、何ヶ月目に植えるかの情報からなり、列 (k(1)​ ,i(1)​ ,j(1)​ ,s(1)​ ),…,(k(M)​ ,i(M)​ ,j(M)​ ,s(M)​ ) で表されます。この列の m 番目の要素は、作物 k(m)​を区画 (i(m)​ ,j(m)​ ) で s(m)​ヶ月目に植えることを意味します。
計画が与えられたとき、t ヶ月目 (t=1,2,…,T) には以下のことを行います。
t ヶ月目の始めに、s(m)​ =t を満たすすべての m について、k(m)​を (i(m)​ ,j(m)​ ) に植える。このとき、各 m について出入口から (i(m)​ ,j(m)​ ) まで水路や栽培中の区画を通ることなく移動できなければならない。
t ヶ月目の終わりに、D(k(m))​=t を満たすすべての m について、k(m)​を (i(m)​ ,j(m)​ ) から収穫する。このとき、各 m について出入口から (i(m)​ ,j(m)​ ) まで水路や栽培中の区画を通ることなく移動できなければならない。
なお、同じ月に複数の作物を植えるとき、植える順番によって上の条件が満たされるかどうかが変わることがあります。例えば、作物 k(1)​と k(2)​を同じ月に植えたく、かつ (i(1)​ ,j(1)​ ) を通らないと (i(2)​ ,j(2)​ ) に移動できない場合、先に k(1)​を植えると k(2)​が植えられなくなります。
このような場合は、各月ごとの植える順番を適切に決めることですべての作物を植えられるなら、実行可能な計画と判定されます。そのような順番が存在するかどうかはジャッジにより判定されるため、計画中で植える順番を指定する必要はありません。同じ月に複数の作物を収穫する場合も同様に、収穫する適切な順番が存在するかどうかはジャッジにより判定されるため、計画中で収穫の順番を指定する必要はありません。
計画は以下の条件を満たす必要があります。
・同じ作物は一つの区画でしか作ることができない
・一つの区画では同時に一つの作物しか作ることができない
・作物 k を植える場合は S(k)​ヶ月目までに植えなければならない
作物を植えたり収穫したりする際、出入口と目的の区画の間を移動できなければならない
なお、すべての作物を植える必要はありません。
得点
作物 k のスコア X(k)​を以下のように定めます。
作物 k が計画に含まれていなければ X(k)​ =0 とする
作物 k が計画に含まれているとき X(k)​ =D(k)​ −S(k)​ +1 とする
AC の判定がされたテストケースの得点は $10^6 \times \frac{\sum_{k=1}^{K} X_k}{HWT}$​ ​となります（この値は暫定テストとシステムテストで使用されるすべてのテストケースに対して整数になります）。AC 以外の判定がされたテストケースの得点は 0 となります。
暫定テストでは、すべてのテストケースでの判定がされた場合は各テストケースの得点の合計が提出の得点となり、そうでない場合は提出の得点は 0 となります。
システムテストでは、各テストケースの得点の合計が提出の得点となります。
最終順位はコンテスト終了後に実施されるより多くの入力に対するシステムテストにおける得点で決定されます。システムテストは以外の結果を得た一番最後の提出に対してのみ行われるため、最終的に提出する解答を間違えないよう注意してください。